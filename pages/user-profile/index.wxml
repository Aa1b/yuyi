<t-navbar title="个人主页" left-arrow />
<view class="user-profile-container">
  <view wx:if="{{loading && !userInfo}}" class="user-profile-loading">
    <t-loading theme="circular" size="40rpx" text="加载中..." />
  </view>

  <view wx:else class="user-profile-content">
    <!-- 用户信息卡片 -->
    <view class="user-profile-header">
      <t-avatar image="{{userInfo.avatar}}" size="large" />
      <view class="user-profile-info">
        <text class="user-profile-name">{{userInfo.nickname}}</text>
        <view class="user-profile-stats">
          <view class="stat-item" bindtap="viewRecords">
            <text class="stat-value">{{userInfo.recordCount || 0}}</text>
            <text class="stat-label">记录</text>
          </view>
          <view class="stat-item" bindtap="viewFollowers">
            <text class="stat-value">{{userInfo.followerCount || 0}}</text>
            <text class="stat-label">粉丝</text>
          </view>
          <view class="stat-item" bindtap="viewFollowing">
            <text class="stat-value">{{userInfo.followingCount || 0}}</text>
            <text class="stat-label">关注</text>
          </view>
        </view>
      </view>
      <!-- 关注按钮 -->
      <view wx:if="{{!isSelf}}" class="user-profile-actions">
        <t-button
          wx:if="{{isFollowing}}"
          theme="light"
          size="small"
          variant="outline"
          bindtap="toggleFollow"
        >
          已关注
        </t-button>
        <t-button
          wx:else
          theme="primary"
          size="small"
          bindtap="toggleFollow"
        >
          关注
        </t-button>
      </view>
    </view>

    <!-- 用户记录列表 -->
    <view class="user-profile-records">
      <view class="records-title">他的记录</view>
      <view wx:if="{{records.length === 0 && !loading}}" class="records-empty">
        <t-empty
          icon="file-image"
          description="还没有发布任何记录"
        />
      </view>
      <view wx:else class="records-list">
        <life-record-card
          wx:for="{{records}}"
          wx:key="id"
          record="{{item}}"
          bindtap="viewDetail"
        />
      </view>
      
      <!-- 加载更多 -->
      <view wx:if="{{loading}}" class="records-loading">
        <t-loading theme="circular" size="32rpx" text="加载中..." />
      </view>
      <view wx:if="{{!hasMore && records.length > 0}}" class="records-no-more">
        <text>没有更多了</text>
      </view>
    </view>
  </view>
</view>

<t-message id="t-message" />
